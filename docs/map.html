<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 6 章 Map | Economic Data Visualization</title>
  <meta name="description" content="第 6 章 Map | Economic Data Visualization" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="第 6 章 Map | Economic Data Visualization" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 6 章 Map | Economic Data Visualization" />
  
  
  

<meta name="author" content="Dr. Lin, Mau-Ting" />


<meta name="date" content="2021-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="scale.html"/>
<link rel="next" href="color.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-104915016-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-104915016-7');

  // ga('set', 'userId', 'USER_ID'); // Set the user ID using signed-in user_id.
</script>
<script src="https://unpkg.com/@popperjs/core@2"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">經濟資料視覺化處理</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#start-a-project"><i class="fa fa-check"></i><b>1.1</b> Start a project</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#中文"><i class="fa fa-check"></i><b>1.2</b> 中文</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#econdv2"><i class="fa fa-check"></i><b>1.3</b> econDV2</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#rprofile"><i class="fa fa-check"></i><b>1.4</b> .Rprofile</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#otherSoftware"><i class="fa fa-check"></i><b>1.5</b> 其他</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html"><i class="fa fa-check"></i><b>2</b> Geometries and Aesthetics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html#an-example"><i class="fa fa-check"></i><b>2.1</b> An Example</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html#econdv2ggdash"><i class="fa fa-check"></i><b>2.1.1</b> econDV2::ggdash</a></li>
<li class="chapter" data-level="2.1.2" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html#script-saving"><i class="fa fa-check"></i><b>2.1.2</b> Script saving</a></li>
<li class="chapter" data-level="2.1.3" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html#graph-output"><i class="fa fa-check"></i><b>2.1.3</b> Graph output</a></li>
<li class="chapter" data-level="2.1.4" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html#ggdash-more"><i class="fa fa-check"></i><b>2.1.4</b> ggdash more</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html#inheritance"><i class="fa fa-check"></i><b>2.2</b> Inheritance</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html#data"><i class="fa fa-check"></i><b>2.2.1</b> Data</a></li>
<li class="chapter" data-level="2.2.2" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html#aesthetics"><i class="fa fa-check"></i><b>2.2.2</b> Aesthetics</a></li>
<li class="chapter" data-level="2.2.3" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html#stop-data-inheritance"><i class="fa fa-check"></i><b>2.2.3</b> Stop data inheritance</a></li>
<li class="chapter" data-level="2.2.4" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html#finish-panel"><i class="fa fa-check"></i><b>2.2.4</b> Finish panel</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="geometries-and-aesthetics.html"><a href="geometries-and-aesthetics.html#graph-export"><i class="fa fa-check"></i><b>2.3</b> Graph export</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="layers.html"><a href="layers.html"><i class="fa fa-check"></i><b>3</b> Layers</a>
<ul>
<li class="chapter" data-level="3.1" data-path="layers.html"><a href="layers.html#time-series-data"><i class="fa fa-check"></i><b>3.1</b> Time series data</a></li>
<li class="chapter" data-level="3.2" data-path="layers.html"><a href="layers.html#aesthetics-inheritance"><i class="fa fa-check"></i><b>3.2</b> Aesthetics inheritance</a></li>
<li class="chapter" data-level="3.3" data-path="layers.html"><a href="layers.html#sequence-of-layers"><i class="fa fa-check"></i><b>3.3</b> Sequence of layers</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="layers.html"><a href="layers.html#line-stroke"><i class="fa fa-check"></i><b>3.3.1</b> Line stroke</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="layers.html"><a href="layers.html#create-your-first-geom"><i class="fa fa-check"></i><b>3.4</b> Create your first geom</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="layers.html"><a href="layers.html#layer-adding"><i class="fa fa-check"></i><b>3.4.1</b> Layer adding</a></li>
<li class="chapter" data-level="3.4.2" data-path="layers.html"><a href="layers.html#new-geom-function"><i class="fa fa-check"></i><b>3.4.2</b> New geom function</a></li>
<li class="chapter" data-level="3.4.3" data-path="layers.html"><a href="layers.html#dot-dot-dot"><i class="fa fa-check"></i><b>3.4.3</b> dot-dot-dot</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="layers.html"><a href="layers.html#summary"><i class="fa fa-check"></i><b>3.5</b> Summary</a></li>
<li class="chapter" data-level="3.6" data-path="layers.html"><a href="layers.html#exercise"><i class="fa fa-check"></i><b>3.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="categorical-data.html"><a href="categorical-data.html"><i class="fa fa-check"></i><b>4</b> Categorical data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="categorical-data.html"><a href="categorical-data.html#aesthetics-group"><i class="fa fa-check"></i><b>4.1</b> Aesthetics: group</a></li>
<li class="chapter" data-level="4.2" data-path="categorical-data.html"><a href="categorical-data.html#geom-overlapping"><i class="fa fa-check"></i><b>4.2</b> Geom overlapping</a></li>
<li class="chapter" data-level="4.3" data-path="categorical-data.html"><a href="categorical-data.html#position-stack"><i class="fa fa-check"></i><b>4.3</b> Position: stack</a></li>
<li class="chapter" data-level="4.4" data-path="categorical-data.html"><a href="categorical-data.html#factor"><i class="fa fa-check"></i><b>4.4</b> Factor</a></li>
<li class="chapter" data-level="4.5" data-path="categorical-data.html"><a href="categorical-data.html#proportional-data"><i class="fa fa-check"></i><b>4.5</b> Proportional data</a></li>
<li class="chapter" data-level="4.6" data-path="categorical-data.html"><a href="categorical-data.html#adding-text"><i class="fa fa-check"></i><b>4.6</b> Adding text</a></li>
<li class="chapter" data-level="4.7" data-path="categorical-data.html"><a href="categorical-data.html#more-on-position"><i class="fa fa-check"></i><b>4.7</b> More on position</a></li>
<li class="chapter" data-level="4.8" data-path="categorical-data.html"><a href="categorical-data.html#coordination-flip"><i class="fa fa-check"></i><b>4.8</b> Coordination flip</a></li>
<li class="chapter" data-level="4.9" data-path="categorical-data.html"><a href="categorical-data.html#summary-1"><i class="fa fa-check"></i><b>4.9</b> Summary</a></li>
<li class="chapter" data-level="4.10" data-path="categorical-data.html"><a href="categorical-data.html#exercise-1"><i class="fa fa-check"></i><b>4.10</b> Exercise</a>
<ul>
<li class="chapter" data-level="" data-path="categorical-data.html"><a href="categorical-data.html#section"><i class="fa fa-check"></i>1</a></li>
<li class="chapter" data-level="" data-path="categorical-data.html"><a href="categorical-data.html#section-1"><i class="fa fa-check"></i>2</a></li>
<li class="chapter" data-level="" data-path="categorical-data.html"><a href="categorical-data.html#section-2"><i class="fa fa-check"></i>3</a></li>
<li class="chapter" data-level="" data-path="categorical-data.html"><a href="categorical-data.html#section-3"><i class="fa fa-check"></i>4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="scale.html"><a href="scale.html"><i class="fa fa-check"></i><b>5</b> Scale</a>
<ul>
<li class="chapter" data-level="5.1" data-path="scale.html"><a href="scale.html#legend"><i class="fa fa-check"></i><b>5.1</b> Legend</a></li>
<li class="chapter" data-level="5.2" data-path="scale.html"><a href="scale.html#time-axis"><i class="fa fa-check"></i><b>5.2</b> Time axis</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="scale.html"><a href="scale.html#custom-axis-function"><i class="fa fa-check"></i><b>5.2.1</b> Custom axis function</a></li>
<li class="chapter" data-level="5.2.2" data-path="scale.html"><a href="scale.html#advanced-function"><i class="fa fa-check"></i><b>5.2.2</b> Advanced function</a></li>
<li class="chapter" data-level="5.2.3" data-path="scale.html"><a href="scale.html#time-period"><i class="fa fa-check"></i><b>5.2.3</b> Time period</a></li>
<li class="chapter" data-level="5.2.4" data-path="scale.html"><a href="scale.html#dot-dot-dot-1"><i class="fa fa-check"></i><b>5.2.4</b> dot-dot-dot</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="scale.html"><a href="scale.html#xy-axis"><i class="fa fa-check"></i><b>5.3</b> XY axis</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="scale.html"><a href="scale.html#expansion-and-out-of-bound"><i class="fa fa-check"></i><b>5.3.1</b> Expansion and out-of-bound</a></li>
<li class="chapter" data-level="5.3.2" data-path="scale.html"><a href="scale.html#secondary-axis"><i class="fa fa-check"></i><b>5.3.2</b> Secondary axis</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="scale.html"><a href="scale.html#colorfill"><i class="fa fa-check"></i><b>5.4</b> Color/Fill</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="scale.html"><a href="scale.html#discrete"><i class="fa fa-check"></i><b>5.4.1</b> Discrete</a></li>
<li class="chapter" data-level="5.4.2" data-path="scale.html"><a href="scale.html#continuous"><i class="fa fa-check"></i><b>5.4.2</b> Continuous</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="scale.html"><a href="scale.html#exercise-2"><i class="fa fa-check"></i><b>5.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="map.html"><a href="map.html"><i class="fa fa-check"></i><b>6</b> Map</a>
<ul>
<li class="chapter" data-level="6.1" data-path="map.html"><a href="map.html#geographic-geoms"><i class="fa fa-check"></i><b>6.1</b> Geographic geoms</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="map.html"><a href="map.html#point-line-and-polygon"><i class="fa fa-check"></i><b>6.1.1</b> Point, Line and Polygon</a></li>
<li class="chapter" data-level="6.1.2" data-path="map.html"><a href="map.html#multipolygons"><i class="fa fa-check"></i><b>6.1.2</b> Multipolygons</a></li>
<li class="chapter" data-level="6.1.3" data-path="map.html"><a href="map.html#fill-polygons"><i class="fa fa-check"></i><b>6.1.3</b> Fill polygons</a></li>
<li class="chapter" data-level="6.1.4" data-path="map.html"><a href="map.html#application-to-world-map"><i class="fa fa-check"></i><b>6.1.4</b> Application to world map</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="map.html"><a href="map.html#simple-feature"><i class="fa fa-check"></i><b>6.2</b> Simple feature</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="map.html"><a href="map.html#define-simple-features"><i class="fa fa-check"></i><b>6.2.1</b> Define simple features</a></li>
<li class="chapter" data-level="6.2.2" data-path="map.html"><a href="map.html#form-simple-feature-column"><i class="fa fa-check"></i><b>6.2.2</b> Form simple feature column</a></li>
<li class="chapter" data-level="6.2.3" data-path="map.html"><a href="map.html#form-simple-feature-data-frame"><i class="fa fa-check"></i><b>6.2.3</b> Form simple feature data frame</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="map.html"><a href="map.html#import-simple-feature-data"><i class="fa fa-check"></i><b>6.3</b> Import Simple Feature Data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="color.html"><a href="color.html"><i class="fa fa-check"></i><b>7</b> Color</a>
<ul>
<li class="chapter" data-level="7.1" data-path="color.html"><a href="color.html#group-aesthetics"><i class="fa fa-check"></i><b>7.1</b> Group aesthetics</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/tpemartin/110-1-Economic-Data-Visualization" target="blank">Course Github</a></li>
<li><a href="https://www.ntpu.edu.tw/econ" target="blank">國立臺北大學 經濟學系</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Economic Data Visualization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="map" class="section level1" number="6">
<h1><span class="header-section-number">第 6 章</span> Map</h1>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="map.html#cb121-1" aria-hidden="true" tabindex="-1"></a>mp <span class="ot">&lt;-</span> econDV2<span class="sc">::</span><span class="fu">Map</span>()</span></code></pre></div>
<div id="geographic-geoms" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Geographic geoms</h2>
<div id="point-line-and-polygon" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Point, Line and Polygon</h3>
<p>ggplot2 is equipped with geoms that can draw all kinds of geographic structure.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="map.html#cb122-1" aria-hidden="true" tabindex="-1"></a>fourPoints <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb122-2"><a href="map.html#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">3</span>),</span>
<span id="cb122-3"><a href="map.html#cb122-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb122-4"><a href="map.html#cb122-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-5"><a href="map.html#cb122-5" aria-hidden="true" tabindex="-1"></a>geometry <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb122-6"><a href="map.html#cb122-6" aria-hidden="true" tabindex="-1"></a>geometry<span class="sc">$</span>ggplot <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb122-7"><a href="map.html#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb122-8"><a href="map.html#cb122-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>fourPoints,</span>
<span id="cb122-9"><a href="map.html#cb122-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(</span>
<span id="cb122-10"><a href="map.html#cb122-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>x, <span class="at">y=</span>y</span>
<span id="cb122-11"><a href="map.html#cb122-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb122-12"><a href="map.html#cb122-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb122-13"><a href="map.html#cb122-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Points:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="map.html#cb123-1" aria-hidden="true" tabindex="-1"></a>geometry<span class="sc">$</span>points <span class="ot">&lt;-</span> geometry<span class="sc">$</span><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb123-2"><a href="map.html#cb123-2" aria-hidden="true" tabindex="-1"></a>geometry<span class="sc">$</span>points </span></code></pre></div>
<p>Path:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="map.html#cb124-1" aria-hidden="true" tabindex="-1"></a>geometry<span class="sc">$</span>path <span class="ot">&lt;-</span> geometry<span class="sc">$</span><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_path</span>()</span>
<span id="cb124-2"><a href="map.html#cb124-2" aria-hidden="true" tabindex="-1"></a>geometry<span class="sc">$</span>path</span></code></pre></div>
<p>Polygon</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="map.html#cb125-1" aria-hidden="true" tabindex="-1"></a>geometry<span class="sc">$</span>polygon <span class="ot">&lt;-</span> geometry<span class="sc">$</span><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_polygon</span>()</span>
<span id="cb125-2"><a href="map.html#cb125-2" aria-hidden="true" tabindex="-1"></a>geometry<span class="sc">$</span>polygon</span></code></pre></div>
<hr />
</div>
<div id="multipolygons" class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Multipolygons</h3>
<ul>
<li>A school consists of many buildings</li>
</ul>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="map.html#cb126-1" aria-hidden="true" tabindex="-1"></a>bigArea <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb126-2"><a href="map.html#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">order=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,</span>
<span id="cb126-3"><a href="map.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">5.5</span>, <span class="fl">5.5</span>, <span class="dv">1</span>,</span>
<span id="cb126-4"><a href="map.html#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>),</span>
<span id="cb126-5"><a href="map.html#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">7</span>,</span>
<span id="cb126-6"><a href="map.html#cb126-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>, <span class="dv">8</span> , <span class="dv">2</span>),</span>
<span id="cb126-7"><a href="map.html#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">building=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;building1&quot;</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">&quot;building2&quot;</span>, <span class="dv">3</span>)), <span class="co"># same school</span></span>
<span id="cb126-8"><a href="map.html#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">contour=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;outer&quot;</span>,<span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">&quot;outer&quot;</span>,<span class="dv">3</span>)) <span class="co"># two different buildings</span></span>
<span id="cb126-9"><a href="map.html#cb126-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb126-10"><a href="map.html#cb126-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-11"><a href="map.html#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="co"># draw each building separately</span></span>
<span id="cb126-12"><a href="map.html#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_polygon</span>(</span>
<span id="cb126-13"><a href="map.html#cb126-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>bigArea, </span>
<span id="cb126-14"><a href="map.html#cb126-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">group=</span>building)</span>
<span id="cb126-15"><a href="map.html#cb126-15" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<ul>
<li><p><code>geom_polygon</code> can draw a polygon with hole(s) by using <code>group</code> and <code>subgroup</code> aesthetics, with hole(s) as a polygon inside another.</p>
<ul>
<li>A building with a courtyard has two contours (one for the outer contour, the other for the courtyard contour). Both contours are polygons belong to the same group, but different subgroups.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="map.html#cb127-1" aria-hidden="true" tabindex="-1"></a>fourPoints<span class="sc">$</span>building<span class="ot">=</span><span class="st">&quot;building1&quot;</span></span>
<span id="cb127-2"><a href="map.html#cb127-2" aria-hidden="true" tabindex="-1"></a>fourPoints<span class="sc">$</span>contour<span class="ot">=</span><span class="st">&quot;courtyard&quot;</span></span>
<span id="cb127-3"><a href="map.html#cb127-3" aria-hidden="true" tabindex="-1"></a>fourPoints<span class="sc">$</span>order<span class="ot">=</span><span class="dv">8</span><span class="sc">:</span><span class="dv">11</span></span>
<span id="cb127-4"><a href="map.html#cb127-4" aria-hidden="true" tabindex="-1"></a>bigArea <span class="sc">|</span><span class="er">&gt;</span> <span class="fu">names</span>()</span>
<span id="cb127-5"><a href="map.html#cb127-5" aria-hidden="true" tabindex="-1"></a>bigAreaWithHoles <span class="ot">&lt;-</span></span>
<span id="cb127-6"><a href="map.html#cb127-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb127-7"><a href="map.html#cb127-7" aria-hidden="true" tabindex="-1"></a>    bigArea,</span>
<span id="cb127-8"><a href="map.html#cb127-8" aria-hidden="true" tabindex="-1"></a>    fourPoints</span>
<span id="cb127-9"><a href="map.html#cb127-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|</span><span class="er">&gt;</span> <span class="fu">arrange</span>(building, order)</span>
<span id="cb127-10"><a href="map.html#cb127-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-11"><a href="map.html#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(bigAreaWithHoles)</span>
<span id="cb127-12"><a href="map.html#cb127-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-13"><a href="map.html#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb127-14"><a href="map.html#cb127-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>bigAreaWithHoles</span>
<span id="cb127-15"><a href="map.html#cb127-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb127-16"><a href="map.html#cb127-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(</span>
<span id="cb127-17"><a href="map.html#cb127-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb127-18"><a href="map.html#cb127-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>x, <span class="at">y=</span>y, </span>
<span id="cb127-19"><a href="map.html#cb127-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">group=</span>building, </span>
<span id="cb127-20"><a href="map.html#cb127-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">subgroup=</span>contour</span>
<span id="cb127-21"><a href="map.html#cb127-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb127-22"><a href="map.html#cb127-22" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="fill-polygons" class="section level3" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Fill polygons</h3>
<ul>
<li>You can give different polygons different fills.</li>
</ul>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="map.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb128-2"><a href="map.html#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>bigAreaWithHoles</span>
<span id="cb128-3"><a href="map.html#cb128-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb128-4"><a href="map.html#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(</span>
<span id="cb128-5"><a href="map.html#cb128-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb128-6"><a href="map.html#cb128-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>x, <span class="at">y=</span>y, </span>
<span id="cb128-7"><a href="map.html#cb128-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">group=</span>building, </span>
<span id="cb128-8"><a href="map.html#cb128-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">subgroup=</span>contour,</span>
<span id="cb128-9"><a href="map.html#cb128-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill=</span>building</span>
<span id="cb128-10"><a href="map.html#cb128-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb128-11"><a href="map.html#cb128-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="application-to-world-map" class="section level3" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> Application to world map</h3>
<p>We apply those <code>geoms</code> to draw some maps.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="map.html#cb129-1" aria-hidden="true" tabindex="-1"></a>world <span class="ot">=</span> ggplot2<span class="sc">::</span><span class="fu">map_data</span>(<span class="st">&quot;world&quot;</span>)</span></code></pre></div>
<hr />
<p>You can pull out certain country data via filter on <code>region</code>.</p>
<ul>
<li>A country can have many polygons defined by <code>subregion</code>, like Taiwan.</li>
</ul>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="map.html#cb130-1" aria-hidden="true" tabindex="-1"></a>world <span class="sc">|</span><span class="er">&gt;</span> </span>
<span id="cb130-2"><a href="map.html#cb130-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb130-3"><a href="map.html#cb130-3" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_detect</span>(region, <span class="st">&quot;Taiwan&quot;</span>)</span>
<span id="cb130-4"><a href="map.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span></span>
<span id="cb130-5"><a href="map.html#cb130-5" aria-hidden="true" tabindex="-1"></a>  taiwan</span>
<span id="cb130-6"><a href="map.html#cb130-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-7"><a href="map.html#cb130-7" aria-hidden="true" tabindex="-1"></a>taiwan <span class="sc">|</span><span class="er">&gt;</span> </span>
<span id="cb130-8"><a href="map.html#cb130-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_polygon</span>(</span>
<span id="cb130-9"><a href="map.html#cb130-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(</span>
<span id="cb130-10"><a href="map.html#cb130-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>long, <span class="at">y=</span>lat, <span class="at">group=</span>subregion</span>
<span id="cb130-11"><a href="map.html#cb130-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-12"><a href="map.html#cb130-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-13"><a href="map.html#cb130-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-14"><a href="map.html#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">coord_map</span>()</span></code></pre></div>
<ul>
<li><p>By default, all geom (except geom_sf) is graphed based on Cartesian coordinate system. You need to <code>+coord_map()</code> to do map projection.</p></li>
<li><p>If multiple coordinate systems are detected, the last coordinate system will be used.</p></li>
</ul>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="map.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do not run </span></span>
<span id="cb131-2"><a href="map.html#cb131-2" aria-hidden="true" tabindex="-1"></a>world <span class="sc">|</span><span class="er">&gt;</span> </span>
<span id="cb131-3"><a href="map.html#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb131-4"><a href="map.html#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(</span>
<span id="cb131-5"><a href="map.html#cb131-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(</span>
<span id="cb131-6"><a href="map.html#cb131-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>long, <span class="at">y=</span>lat, <span class="at">group=</span>subregion</span>
<span id="cb131-7"><a href="map.html#cb131-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb131-8"><a href="map.html#cb131-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span><span class="st">&quot;white&quot;</span>, </span>
<span id="cb131-9"><a href="map.html#cb131-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb131-10"><a href="map.html#cb131-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>ggplot2 has a more efficient geom (<code>geom_map</code>) to deal with data from <code>ggplot2::map_data()</code>. However, you need to prepare another data set for social-geographic graphing purpose, like</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="map.html#cb132-1" aria-hidden="true" tabindex="-1"></a>map_value <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb132-2"><a href="map.html#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">region=</span>world<span class="sc">$</span>region <span class="sc">|</span><span class="er">&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb132-3"><a href="map.html#cb132-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li><code>map_value</code> could be a data frame describe different region’s gdp for example.</li>
</ul>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="map.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb133-2"><a href="map.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>map_value</span>
<span id="cb133-3"><a href="map.html#cb133-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb133-4"><a href="map.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_map</span>(</span>
<span id="cb133-5"><a href="map.html#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span></span>
<span id="cb133-6"><a href="map.html#cb133-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">map_id=</span>region),</span>
<span id="cb133-7"><a href="map.html#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">map=</span>world,</span>
<span id="cb133-8"><a href="map.html#cb133-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span></span>
<span id="cb133-9"><a href="map.html#cb133-9" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<ul>
<li><p>aesthetic <code>map_id</code> is required for join other values from <code>ggplot data</code></p></li>
<li><p>The <code>geom_map</code> does not define xy limits for a graph; hence no background map shown.</p></li>
<li><p>We can force ggplot to shows graph that covers certain limits via <code>expand_limits</code></p></li>
</ul>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="map.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">last_plot</span>()<span class="sc">+</span></span>
<span id="cb134-2"><a href="map.html#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> world<span class="sc">$</span>long, <span class="at">y =</span> world<span class="sc">$</span>lat)</span></code></pre></div>
<p>World map with different fills:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="map.html#cb135-1" aria-hidden="true" tabindex="-1"></a>map_value<span class="sc">$</span>region <span class="sc">|</span><span class="er">&gt;</span> <span class="fu">length</span>()</span>
<span id="cb135-2"><a href="map.html#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2938</span>)</span>
<span id="cb135-3"><a href="map.html#cb135-3" aria-hidden="true" tabindex="-1"></a>map_value<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">252</span>, T)</span>
<span id="cb135-4"><a href="map.html#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="map.html#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb135-6"><a href="map.html#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>map_value</span>
<span id="cb135-7"><a href="map.html#cb135-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb135-8"><a href="map.html#cb135-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_map</span>(</span>
<span id="cb135-9"><a href="map.html#cb135-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span></span>
<span id="cb135-10"><a href="map.html#cb135-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">map_id=</span>region, <span class="at">fill=</span>value),</span>
<span id="cb135-11"><a href="map.html#cb135-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">map=</span>world,</span>
<span id="cb135-12"><a href="map.html#cb135-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb135-13"><a href="map.html#cb135-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb135-14"><a href="map.html#cb135-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x=</span>world<span class="sc">$</span>long, <span class="at">y=</span>world<span class="sc">$</span>lat)</span></code></pre></div>
<hr />
<p>Exclude Antartica</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="map.html#cb136-1" aria-hidden="true" tabindex="-1"></a>world2 <span class="ot">&lt;-</span> world <span class="sc">|</span><span class="er">&gt;</span> </span>
<span id="cb136-2"><a href="map.html#cb136-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb136-3"><a href="map.html#cb136-3" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">!=</span> <span class="st">&quot;Antarctica&quot;</span></span>
<span id="cb136-4"><a href="map.html#cb136-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb136-5"><a href="map.html#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb136-6"><a href="map.html#cb136-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>world2 <span class="sc">|</span><span class="er">&gt;</span> <span class="fu">group_by</span>(region) <span class="sc">|</span><span class="er">&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb136-7"><a href="map.html#cb136-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb136-8"><a href="map.html#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_map</span>(</span>
<span id="cb136-9"><a href="map.html#cb136-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(</span>
<span id="cb136-10"><a href="map.html#cb136-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">map_id=</span>region</span>
<span id="cb136-11"><a href="map.html#cb136-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb136-12"><a href="map.html#cb136-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">map=</span>world2, </span>
<span id="cb136-13"><a href="map.html#cb136-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb136-14"><a href="map.html#cb136-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb136-15"><a href="map.html#cb136-15" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb136-16"><a href="map.html#cb136-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(</span>
<span id="cb136-17"><a href="map.html#cb136-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>world2<span class="sc">$</span>long,</span>
<span id="cb136-18"><a href="map.html#cb136-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>world2<span class="sc">$</span>lat</span>
<span id="cb136-19"><a href="map.html#cb136-19" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
</div>
<div id="simple-feature" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Simple feature</h2>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="map.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>)</span></code></pre></div>
<ul>
<li><a href="https://r-spatial.github.io/sf/" class="uri">https://r-spatial.github.io/sf/</a></li>
</ul>
<p>Another type of geographic data structure.</p>
<ul>
<li><p>a new class. Each value in a simple feature vector represents a form of geometry (called <strong>feature</strong>) and its geographic notation (i.e. latitude and longitude); and could carry its coordinate reference system.</p></li>
<li><p>Each value is a parsing result from <code>sf::st_xxx</code> functions where <code>xxx</code> can be <code>point</code> (台北大學的一個地標，如<a href="https://www.google.com.tw/maps/place/YouBike+1.0/@24.9425965,121.3700117,18z/data=!4m5!3m4!1s0x34681b7d1f8d8569:0x5d135a3058409b3e!8m2!3d24.94317!4d121.36952">YouBike站</a>), <code>multipoint</code> (台北大學所有地標), <code>linestring</code>(台北大學的一條路徑), <code>polygon</code>(台北大學的一棟建築), <code>multilinestring</code>(台北大學的所有路徑), <code>multipolygon</code>(台北大學的所有建築), or <code>geometrycollection</code>(整個台北大學)</p></li>
</ul>
<div id="define-simple-features" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Define simple features</h3>
<p>A simple feature is composed of numeric vector, matrix, or list. No data frame is used.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="map.html#cb138-1" aria-hidden="true" tabindex="-1"></a>geoValues <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb138-2"><a href="map.html#cb138-2" aria-hidden="true" tabindex="-1"></a>geoValues<span class="sc">$</span>simple_feature<span class="sc">$</span>point <span class="ot">&lt;-</span></span>
<span id="cb138-3"><a href="map.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_point</span>(</span>
<span id="cb138-4"><a href="map.html#cb138-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fl">24.9433123</span>, <span class="fl">121.3699526</span>)</span>
<span id="cb138-5"><a href="map.html#cb138-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-6"><a href="map.html#cb138-6" aria-hidden="true" tabindex="-1"></a>geoValues<span class="sc">$</span>simple_feature<span class="sc">$</span>multipoint <span class="ot">&lt;-</span></span>
<span id="cb138-7"><a href="map.html#cb138-7" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_multipoint</span>(</span>
<span id="cb138-8"><a href="map.html#cb138-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rbind</span>( <span class="co"># will form a matrix</span></span>
<span id="cb138-9"><a href="map.html#cb138-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fl">24.9443019</span>, <span class="fl">121.3714944</span>), <span class="co"># 1st point</span></span>
<span id="cb138-10"><a href="map.html#cb138-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fl">24.9440709</span>, <span class="fl">121.3728518</span>) <span class="co"># 2nd point</span></span>
<span id="cb138-11"><a href="map.html#cb138-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb138-12"><a href="map.html#cb138-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-13"><a href="map.html#cb138-13" aria-hidden="true" tabindex="-1"></a>geoValues<span class="sc">$</span>simple_feature<span class="sc">$</span>linestring <span class="ot">&lt;-</span></span>
<span id="cb138-14"><a href="map.html#cb138-14" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_linestring</span>(</span>
<span id="cb138-15"><a href="map.html#cb138-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rbind</span>(</span>
<span id="cb138-16"><a href="map.html#cb138-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fl">24.9423755</span>, <span class="fl">121.3679438</span>), <span class="co"># 1st trace point</span></span>
<span id="cb138-17"><a href="map.html#cb138-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fl">24.9429941</span>, <span class="fl">121.3679432</span>), <span class="co"># 2nd trace point</span></span>
<span id="cb138-18"><a href="map.html#cb138-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fl">24.9432087</span>, <span class="fl">121.3686713</span>) <span class="co"># 3rd trace point</span></span>
<span id="cb138-19"><a href="map.html#cb138-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb138-20"><a href="map.html#cb138-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-21"><a href="map.html#cb138-21" aria-hidden="true" tabindex="-1"></a>geoValues<span class="sc">$</span>simple_feature<span class="sc">$</span>polygon <span class="ot">&lt;-</span></span>
<span id="cb138-22"><a href="map.html#cb138-22" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_polygon</span>(</span>
<span id="cb138-23"><a href="map.html#cb138-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb138-24"><a href="map.html#cb138-24" aria-hidden="true" tabindex="-1"></a>      <span class="co"># 1st closed trace</span></span>
<span id="cb138-25"><a href="map.html#cb138-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rbind</span>(</span>
<span id="cb138-26"><a href="map.html#cb138-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="fl">24.9441895</span>, <span class="fl">121.3695181</span>),</span>
<span id="cb138-27"><a href="map.html#cb138-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="fl">24.9442244</span>, <span class="fl">121.3692544</span>),</span>
<span id="cb138-28"><a href="map.html#cb138-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="fl">24.9437158</span>, <span class="fl">121.3694094</span>),</span>
<span id="cb138-29"><a href="map.html#cb138-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="fl">24.9438647</span>, <span class="fl">121.3696271</span>),</span>
<span id="cb138-30"><a href="map.html#cb138-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="fl">24.9441895</span>, <span class="fl">121.3695181</span>) <span class="co"># close the polygon</span></span>
<span id="cb138-31"><a href="map.html#cb138-31" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb138-32"><a href="map.html#cb138-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb138-33"><a href="map.html#cb138-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-34"><a href="map.html#cb138-34" aria-hidden="true" tabindex="-1"></a><span class="co"># polygon: a list consists of matrices.</span></span></code></pre></div>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="map.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(geoValues<span class="sc">$</span>simple_feature<span class="sc">$</span>point)</span>
<span id="cb139-2"><a href="map.html#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(geoValues<span class="sc">$</span>simple_feature<span class="sc">$</span>linestring)</span>
<span id="cb139-3"><a href="map.html#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(geoValues<span class="sc">$</span>simple_feature<span class="sc">$</span>polygon)</span>
<span id="cb139-4"><a href="map.html#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co"># all have sfg class</span></span></code></pre></div>
<p>Simple feature value can be graphed directly via <code>geom_sf()</code></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="map.html#cb140-1" aria-hidden="true" tabindex="-1"></a>geoValues<span class="sc">$</span>simple_feature<span class="sc">$</span>polygon <span class="sc">|</span><span class="er">&gt;</span> <span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_sf</span>()</span></code></pre></div>
</div>
<div id="form-simple-feature-column" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Form simple feature column</h3>
<p>A collection column of multiple simple features.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="map.html#cb141-1" aria-hidden="true" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_sfc</span>(geoValues<span class="sc">$</span>simple_feature) <span class="ot">-&gt;</span> geoValues<span class="sc">$</span>simple_feature_column</span>
<span id="cb141-2"><a href="map.html#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="map.html#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(geoValues<span class="sc">$</span>simple_feature_column) <span class="co"># &quot;sfc_GEOMETRY&quot; &quot;sfc&quot; </span></span>
<span id="cb141-4"><a href="map.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co"># has class sfc</span></span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="map.html#cb142-1" aria-hidden="true" tabindex="-1"></a>geoValues<span class="sc">$</span>simple_feature_column <span class="sc">|</span><span class="er">&gt;</span> </span>
<span id="cb142-2"><a href="map.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_sf</span>()</span></code></pre></div>
</div>
<div id="form-simple-feature-data-frame" class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Form simple feature data frame</h3>
<ul>
<li>A simple feature data frame is basically a data frame with a column named <strong>geometry</strong> which is a list of each obervation’s simple feature value.</li>
</ul>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="map.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initiate a data frame</span></span>
<span id="cb143-2"><a href="map.html#cb143-2" aria-hidden="true" tabindex="-1"></a>df_sf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb143-3"><a href="map.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">name=</span><span class="fu">c</span>(<span class="st">&quot;landmark 1&quot;</span>, <span class="st">&quot;must-see landmarks&quot;</span>, <span class="st">&quot;path 1&quot;</span>, <span class="st">&quot;building 1&quot;</span>)</span>
<span id="cb143-4"><a href="map.html#cb143-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb143-5"><a href="map.html#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="map.html#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="co"># add simple feature column</span></span>
<span id="cb143-7"><a href="map.html#cb143-7" aria-hidden="true" tabindex="-1"></a>df_sf <span class="sc">|</span><span class="er">&gt;</span> sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(geoValues<span class="sc">$</span>simple_feature_column) <span class="ot">-&gt;</span></span>
<span id="cb143-8"><a href="map.html#cb143-8" aria-hidden="true" tabindex="-1"></a>  geoValues<span class="sc">$</span>simple_feature_df</span>
<span id="cb143-9"><a href="map.html#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="map.html#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df_sf) <span class="co"># only &quot;data frame&quot;</span></span>
<span id="cb143-11"><a href="map.html#cb143-11" aria-hidden="true" tabindex="-1"></a>df_sf <span class="sc">|</span><span class="er">&gt;</span></span>
<span id="cb143-12"><a href="map.html#cb143-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb143-13"><a href="map.html#cb143-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">geometry=</span>geoValues<span class="sc">$</span>simple_feature_column</span>
<span id="cb143-14"><a href="map.html#cb143-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> df_sf2</span>
<span id="cb143-15"><a href="map.html#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df_sf2) <span class="co"># still a &quot;data frame&quot;</span></span>
<span id="cb143-16"><a href="map.html#cb143-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Must go through sf::st_set_geometry to get sf class</span></span>
<span id="cb143-17"><a href="map.html#cb143-17" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(geoValues<span class="sc">$</span>simple_feature_df) <span class="co"># &quot;sf&quot; &quot;data.frame&quot;</span></span>
<span id="cb143-18"><a href="map.html#cb143-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-19"><a href="map.html#cb143-19" aria-hidden="true" tabindex="-1"></a>geoValues<span class="sc">$</span>simple_feature_df <span class="sc">|</span><span class="er">&gt;</span> <span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_sf</span>()</span></code></pre></div>
<!--

### Save simple feature data frame

  * save as **.shp** file


```r
sf::write_sf(dfsf,"sf_df_example.shp")
geoValues$simple_feature_df[1, ] |> 
  sf::write_sf("sfdf.shp")
geoValues$simple_feature_df$geometry |>
  sf::st_cast("GEOMETRYCOLLECTION") -> dfsf
geoValues$simple_feature_df$geometry |> sf::
```



```r
print(df_sf$geometry)
```

```
Geometry set for 4 features 
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: 24.9 ymin: 120 xmax: 25 ymax: 122
CRS:           NA
POINT (24.943 121.3709)
MULTIPOINT ((24.94 121.37), (24.95 121.38))
LINESTRING (24.94 121.37, 24.95 121.38, 24.956 ...
POLYGON ((24.94 121.37, 24.95 121.38, 24.956 12...
```

<div class="alert alert-info">
**Coordinate Reference Systems (CRS)**
包含兩部份：

  * geographic coordinate reference systems: 經度、緯度，衡量規則通常為WGS84。

  * projected coordinate reference systems：怎麼把球體上的地理位置投射成2維經緯平面，受投射中心點及投射方法選擇影響。

不同CRS在2維平面投出的地理形狀、兩點距離、兩點角度會有不同結果；在繪圖時需要特別聲明。常見的地圖，如Google map，使用epsg 4326:

  * <https://epsg.io/map#srs=4326&x=0.000000&y=0.000000&z=1&layer=streets>


```r
df_sf$geometry |> 
  sf::st_set_crs("WGS84") -> df_sf$geometry
# OR
df_sf |>
  sf::st_set_crs(4326) -> df_sf
print(df_sf$geometry)
```

</div>


```r
gg0 <- 
  ggplot(data=df_sf) + geom_sf()
gg0
```




-->
</div>
</div>
<div id="import-simple-feature-data" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Import Simple Feature Data</h2>
<ul>
<li><a href="https://tpemartin.github.io/economic-data-visualization/zh-tw/annotation-and-maps.html#%E8%AE%80%E5%85%A5shp%E6%AA%94" class="uri">https://tpemartin.github.io/economic-data-visualization/zh-tw/annotation-and-maps.html#%E8%AE%80%E5%85%A5shp%E6%AA%94</a></li>
</ul>
<!--

## Map overlay



```r
xfun::download_file("https://www.dropbox.com/s/kvjpd1idvsln41k/20-Mar-2021-sanxiaBikeRoute.gpx?dl=1")
econDV2::Object(bikeRoute)
bikeRoute$data$raw <- 
  plotKML::readGPX(
    gpx.file="20-Mar-2021-sanxiaBikeRoute.gpx")
bikeRoute$data$track <-
  bikeRoute$data$raw$tracks[[1]][[1]]
```


```r
ggplot() +
  geom_path(
    data=bikeRoute$data$track,
    mapping=
      aes(
        x=lon,
        y=lat
      )
  ) + coord_map()
```

### Raster image


```r
mp$browse$openstreetmap()
```



```r
mp$copy_paste$osm_bbox()
```
left=121.3512,
bottom=24.9435,
right=121.3849,
top=24.9615



```r
img <- list()
xfun::download_file("https://www.dropbox.com/s/e2kct9xropvg1h5/map_sanxia.png?dl=1")
magick::image_read("map_sanxia.png") -> img$raw
magick::image_resize(
  img$raw,
  geometry = magick::geometry_size_percent(width = 50, height = NULL)
) -> img$resize

magick::image_flatten(
  img$raw
) -> img$flatten

magick::image_write(
  img$resize, path="map_resize.png"
)
```


```r
check_size <- function(x){
  x |> magick::image_raster() |>
    pryr::object_size()
}
```


```r
raster_0 <- magick::image_raster(
  img$raw
)
pryr::object_size(raster_0)

raster_map <- magick::image_raster(img$resize)
pryr::object_size(raster_map)
raster_flatmap <- 
  magick::image_raster(img$flatten)
pryr::object_size(raster_flatmap)


img$raw |> check_size()

img$raw |>
  magick::image_quantize(colorspace="gray") |> 
  check_size()

img$raw |> 
  magick::image_quantize(
    max=30,
    colorspace = "gray") |> #print()
  check_size()

img$raw |> 
  magick::image_quantize(
    max=30,
    colorspace = "gray") |>
  magick::image_resize(
    geometry = magick::geometry_size_percent(80)
  ) |> #print()
  check_size()

img$raw |> 
  magick::image_quantize(
    max=30,
    colorspace = "gray") |>
  magick::image_resize(
    geometry = magick::geometry_size_percent(80)
  ) |>
  magick::image_raster() -> img$resize_gray
```


```r
img$resize_gray$col |> unique() -> colorlimit
ggplot()+
  geom_raster(
    data=img$resize_gray,
    mapping=aes(
      x=x, y=y, fill=col
    )
  )+
  scale_fill_manual(
    limits = colorlimit,
    values = colorlimit
  )+
  theme(
    legend.position = "none"
  )-> gg1

gg1
```



```r
econDV2::Object(overlay)
overlay$raster$google <- {
  ggmap::get_map(
  c(lon=121.3684249, lat=24.9521791),
  zoom=15)
}
overlay$raster$statmen <- {
  
}
overlay$raster$osm <- {
  ggmap::get_map(
    c(left=121.34759,
bottom=24.94224,
right=121.38503,
top=24.96071),
    source="osm"
  )
}
```



```r
attach(bikeRoute$data)
{
  track[c("lon", "lat")] |> as.matrix() |> sf::st_linestring() -> track_linestring
  
  track_linestring |> sf::st_crs()
  
  ggplot()+geom_sf(data=track_linestring, crs=NULL)
  
  ggmap::get_map(
c(lon=121.3684249, lat=24.9521791),
zoom=15  ) -> raster_ntpu
  
  
  ggmap(raster_ntpu) -> gg_ntpu
  
  gg_ntpu |> sf::st_crs()
  raster_ntpu |> sf::st_crs()
  track_linestring |> sf::st_crs()
  
  gg_ntpu + geom_sf(
    data=track_linestring,
    inherit.aes = F
  )+theme_void()

  # gg_ntpu and geom_sf are two different coordinate systems by concepts. Here both has no crs setting. So the warning is wrong.
}
detach(bikeRoute$data)
```


```r
us <- c(left = -125, bottom = 25.75, right = -67, top = 49)
get_stamenmap(us, zoom = 5, maptype = "toner-lite") |> ggmap() 
```


## Raster map 


```r
us <- c(left = -125, bottom = 25.75, right = -67, top = 49)
bbox_ntpu <- 
  c(top=24.94709,
right=121.37619,
bottom=24.93842,
left=121.36230)
ggmap::get_map(
  location= c(lon=121.37015,lat=24.94311),
  source="osm"
)
ggmap::get_openstreetmap(
  bbox=bbox_ntpu
) -> map_ntpu 
get_stamenmap(us, zoom = 5, maptype = "toner-lite") %>% ggmap()  -> gg0
```


24.94709 (top)
121.37619 (right)
24.93842
121.36230




```r
magick::image_read("/Users/martinl/Downloads/map_ntpu.png") -> map_ntpu
magick::image_raster(map_ntpu) -> raster_ntpu
pryr::object_size(raster_ntpu) # extremely big
```

  * **Raster** is not an efficient way to store image information. 
  

```r
newTaipeiBBox <- c(xmin=121.28263, ymin=24.67316, xmax=122.00640, ymax=25.29974)
```


## open street map (OSM)

  * <https://openstreetmap.org>


```r
browseURL("https://openstreetmap.org")
```

## ggmap


```r
ggmap::get_openstreetmap(
  
)
```



```r
library("ggmap")
#  Loading required package: ggplot2
#  Registered S3 methods overwritten by 'ggplot2':
#    method         from 
#    [.quosures     rlang
#    c.quosures     rlang
#    print.quosures rlang
#  Google's Terms of Service: https://cloud.google.com/maps-platform/terms/.
#  Please cite ggmap if you use it! See citation("ggmap") for details.

us <- c(left = -125, bottom = 25.75, right = -67, top = 49)
get_stamenmap(us, zoom = 5, maptype = "toner-lite") %>% ggmap()  -> gg0
gg0 |> class()
gg0$data
ggmap |> body() |> clipr::write_clip()
```

-->

</div>
</div>
<!--參考答案開關--> 
<script>
$(document).ready(function(){
  $('<button class="flip">More info...</button>').insertBefore(".more");
  $(".flip").click(function(){
    $(this).next().slideToggle();
  });
})
</script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>

<!-- 2. Include library -->
<script src="js/clipboard.min.js"></script>

<!-- 3. Instantiate clipboard by passing a string selector -->

<script>
var clipboard = new Clipboard('.btn');
clipboard.on('success', function(e) {
    console.log(e);
});
clipboard.on('error', function(e) {
    console.log(e);
});
</script>

<script>
  var copyTextareaBtn = document.querySelector('.js-textareacopybtn');

copyTextareaBtn.addEventListener('click', function(event) {
  var copyTextarea = document.querySelector('.js-copytextarea');
  copyTextarea.select();

  try {
    var successful = document.execCommand('copy');
    var msg = successful ? 'successful' : 'unsuccessful';
    console.log('Copying text command was ' + msg);
  } catch (err) {
    console.log('Oops, unable to copy');
  }
});
</script>

<script>
  function CopyToClipboard(containerid) {
if (document.selection) {
    var range = document.body.createTextRange();
    range.moveToElementText(document.getElementById(containerid));
    range.select().createTextRange();
    document.execCommand("copy");

} else if (window.getSelection) {
    var range = document.createRange();
     range.selectNode(document.getElementById(containerid));
     window.getSelection().addRange(range);
     document.execCommand("copy");
     alert("text copied")
}}
</script>

<script>
  $( document ).ready(function() {
    addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
});
</script>
<!--
<script>
  $(document).ready(function() {
  var codes = document.querySelectorAll('pre:not([class])');
  var code, i, d, s, p;
  for (i = 0; i < codes.length; i++) {
    code = codes[i];
    p = code.parentNode;
    d = document.createElement('details');
    s = document.createElement('summary');
    s.innerText = 'Details';
    // <details><summary>Details</summary></details>
    d.appendChild(s);
    // move the code into <details>
    p.replaceChild(d, code);
    d.appendChild(code);
  }
});
</script>
-->
<!--
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'https://gitter.im/NTPU-Econ/Econometrics'
  };
</script>

<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
-->
<script src="js/documentReady.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="scale.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="color.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"theme": "united"
});
});
</script>

</body>

</html>
